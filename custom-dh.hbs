{{!< default}} <meta name="keywords"
    content="DH parameters calculator,DH calculator,Forward Kinematics calculator,Denavit-Hartenberg Forward kinematics,Denavit-Hartenberg,Denavit Hartenberg,Denavit Hartenberg parameter,DH,Denavit,Hartenberg,prajankya sonar,robotics,6DOF,DOF,kinematics,Forward,DH parameters,robotics">
    {{!-- The tag above means: insert everything in this file
    into the {body} of the default.hbs template --}}

    {{!-- The big featured header, it uses blog cover image as a BG if available --}}
    <header class="site-header">
        <div class="outer site-nav-main">
            <div class="inner">
                {{> "site-nav"}}
            </div>
        </div>
    </header>

    {{!-- Everything inside the #post tags pulls data from the post --}}
    {{#post}}

    <main id="site-main" class="site-main outer">
        <div class="inner">

            <article class="post-full {{post_class}} {{#unless feature_image}}no-image{{/unless}}">

                <header class="post-full-header">
                    <h1 class="post-full-title">{{title}}</h1>
                </header>

                {{#if feature_image}}
                <figure class="post-full-image">
                    {{!-- This is a responsive image, it loads different sizes depending on device
                    https://medium.freecodecamp.org/a-guide-to-responsive-images-with-ready-to-use-templates-c400bd65c433
                    --}}
                    <img srcset="{{img_url feature_image size=" s"}} 300w, {{img_url feature_image size="m" }} 600w,
                        {{img_url feature_image size="l" }} 1000w, {{img_url feature_image size="xl" }} 2000w" sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 1170px,
                            2000px" src="{{img_url feature_image size=" xl"}}" alt="{{title}}" />
                </figure>
                {{/if}}

                <section class="post-full-content">
                    <div class="post-content" ng-app="MyApp" ng-controller="MyController">
                        {{content}}
                    </div>
                </section>

            </article>

        </div>
    </main>

    <div class="modal fade" id="demoModal" tabindex="-1" role="dialog" aria-labelledby="demoModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="demoModalLabel">More Info about Demo Robot</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>The Example DH parameters are for ABB IRB120.</p>
                    <div class="">
                        <div class=" side_img" ng-click="openNewWindow('/images/others/abb_irb120.png')">
                            <picture>
                                <source media="(min-width: 900px)"
                                    srcset="/images/others/abb_irb120-1440_1x.webp 1x, /images/others/abb_irb120-1440_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 600px)"
                                    srcset="/images/others/abb_irb120-900_1x.webp 1x, /images/others/abb_irb120-900_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 200px)"
                                    srcset="/images/others/abb_irb120-600_1x.webp 1x, /images/others/abb_irb120-600_2x.webp 2x"
                                    type="image/webp">
                                <source
                                    srcset="/images/others/abb_irb120-200_1x.webp 1x, /images/others/abb_irb120-200_2x.webp 2x"
                                    type="image/webp">
                                <img alt="Front page"
                                    srcset="/images/others/abb_irb120-200.png 200w, /images/others/abb_irb120-600.png 600w, /images/others/abb_irb120-900.png 900w, /images/others/abb_irb120-1440.png 1440w"
                                    src="/images/others/abb_irb120.png">
                            </picture>
                        </div>
                        <div class="side_img" ng-click="openNewWindow('/images/others/abb_irb120_dh.png')">
                            <picture>
                                <source media="(min-width: 900px)"
                                    srcset="/images/others/abb_irb120_dh-1440_1x.webp 1x, /images/others/abb_irb120_dh-1440_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 600px)"
                                    srcset="/images/others/abb_irb120_dh-900_1x.webp 1x, /images/others/abb_irb120_dh-900_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 200px)"
                                    srcset="/images/others/abb_irb120_dh-600_1x.webp 1x, /images/others/abb_irb120_dh-600_2x.webp 2x"
                                    type="image/webp">
                                <source
                                    srcset="/images/others/abb_irb120_dh-200_1x.webp 1x, /images/others/abb_irb120_dh-200_2x.webp 2x"
                                    type="image/webp">
                                <img alt="Front page"
                                    srcset="/images/others/abb_irb120_dh-200.png 200w, /images/others/abb_irb120_dh-600.png 600w, /images/others/abb_irb120_dh-900.png 900w, /images/others/abb_irb120_dh-1440.png 1440w"
                                    src="/images/others/abb_irb120_dh.png">
                            </picture>
                        </div>
                        <div class="side_img" ng-click="openNewWindow('/images/others/irb_dh_params.png')">
                            <picture>
                                <source media="(min-width: 900px)"
                                    srcset="/images/others/irb_dh_params-1440_1x.webp 1x, /images/others/irb_dh_params-1440_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 600px)"
                                    srcset="/images/others/irb_dh_params-900_1x.webp 1x, /images/others/irb_dh_params-900_2x.webp 2x"
                                    type="image/webp">
                                <source media="(min-width: 200px)"
                                    srcset="/images/others/irb_dh_params-600_1x.webp 1x, /images/others/irb_dh_params-600_2x.webp 2x"
                                    type="image/webp">
                                <source
                                    srcset="/images/others/irb_dh_params-200_1x.webp 1x, /images/others/irb_dh_params-200_2x.webp 2x"
                                    type="image/webp">
                                <img alt="Front page"
                                    srcset="/images/others/irb_dh_params-200.png 200w, /images/others/irb_dh_params-600.png 600w, /images/others/irb_dh_params-900.png 900w, /images/others/irb_dh_params-1440.png 1440w"
                                    src="/images/others/irb_dh_params.png">
                            </picture>
                        </div>

                    </div>
                    <small>The Robot and the images related to it are courtesy of abb.com website and are used here
                        as
                        reference only.</small>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="demoConfirmModal" tabindex="-1" role="dialog" aria-labelledby="demoConfirmModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="demoConfirmModalLabel">Confirm to replace all the data?</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Demo Example will replace all the links already existing.
                    <br>
                    All the links/data entered in the table
                    will be removed.
                    <br>
                    <br>
                    Do you want to continue ?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-warning" ng-click="demoConfirmModalSubmit()">REPLACE and
                        Load
                        demo</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="removeConfirmModal" tabindex="-1" role="dialog"
        aria-labelledby="removeConfirmModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="removeConfirmModalLabel">Do you want to remove?</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you want to remove <i>[[link_to_remove_name]]</i>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" ng-click="RemoveConfirmed()">REMOVE
                        <i>[[link_to_remove_name]]</i>
                    </button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    {{/post}}

    {{!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in
    default.hbs --}}
    {{#contentFor "scripts"}}

    <style>
        .modal {
            display: none;
        }

        /**/
        .form-control {
            display: block;
            min-width: 40px;
            width: 100%;
            padding: 2px;
            font-size: 1.3rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: .25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        .btn-success.disabled,
        .btn-success:disabled {
            color: #fff;
            background-color: #28a745;
            border-color: #28a745;
        }

        .btn-secondary {
            color: #fff;
            background-color: #6c757d;
            border-color: #6c757d;
        }

        .btn.disabled,
        .btn:disabled {
            opacity: .65;
        }

        [type=reset],
        [type=submit],
        button,
        html [type=button] {
            -webkit-appearance: button;
        }

        .pb-2,
        .py-2 {
            padding-bottom: .5rem !important;
        }

        .btn-success {
            color: #fff;
            background-color: #28a745;
            border-color: #28a745;
        }

        .btn {
            display: inline-block;
            font-weight: 400;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            border: 1px solid transparent;
            padding: .375rem .75rem;
            border-radius: .25rem;
            transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        button,
        input {
            overflow: visible;
        }

        .modal-open {
            padding-right: 0px !important;
        }

        /**/
        .formula {
            font-family: monospace;
            line-height: normal;
            text-align: center;
            padding: 12px 16px;
            background: rgba(125, 125, 125, 0.5);
        }

        .mono {
            font-family: monospace;
            line-height: normal;
            font-weight: 700;
            padding: 4px 8px;
            font-size: 16px;
            background: rgba(125, 125, 125, 0.5);
        }

        .matrix table {
            display: table;
            font-family: monospace;
            white-space: pre;
            line-height: normal;
            margin: 0;
            width: 100%;

            border-left: 2px solid #000;
            border-right: 2px solid #000;
        }

        .matrix>table>tr>td {
            position: relative;
        }

        .matrix>table>tr:first-child>td:first-child:before {
            content: " ";
            position: absolute;
            display: block;
            left: -1px;
            top: -1px;
            width: 16px;
            border-top: 2px solid black;
        }

        .matrix>table>tr:first-child>td:last-child:before {
            content: " ";
            position: absolute;
            display: block;
            right: -1px;
            top: -1px;
            width: 16px;
            border-top: 2px solid black;
        }

        .matrix>table>tr:last-child>td:first-child:after {
            content: " ";
            position: absolute;
            display: block;
            left: -1px;
            bottom: -1px;
            width: 16px;
            border-bottom: 2px solid black;
        }

        .matrix>table>tr:last-child>td:last-child:after {
            content: " ";
            position: absolute;
            right: -1px;
            bottom: -1px;
            width: 16px;
            border-bottom: 2px solid black;
        }
    </style>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        crossorigin="anonymous"></script>

    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>

    <script>
        var app = angular.module('MyApp', [], function ($interpolateProvider) {
            $interpolateProvider.startSymbol('[[');
            $interpolateProvider.endSymbol(']]');
        });

        app.filter('reverse', function () {
            return function (items) {
                return items.slice().reverse();
            };
        });

        app.controller('MyController', function ($scope, $window, $timeout, $sce) {
            $scope.links = [];

            var demo_links = [{
                a: 0,
                alpha: -90,
                d: 290,
                theta: 0,
                name: "Link 1"
            }, {
                a: 270,
                alpha: 0,
                d: 0,
                theta: -90,
                name: "Link 2"
            }, {
                a: -70,
                alpha: 90,
                d: 0,
                theta: 180,
                name: "Link 3"
            }, {
                a: 0,
                alpha: -90,
                d: 302,
                theta: 0,
                name: "Link 4"
            }, {
                a: 0,
                alpha: 90,
                d: 0,
                theta: 0,
                name: "Link 5"
            }, {
                a: 0,
                alpha: 0,
                d: 72,
                theta: 0,
                name: "Link 6"
            }];

            $scope.loadExample = function () {
                if ($scope.links.length > 0) {
                    $('#demoConfirmModal').modal()
                } else {
                    $scope.links = angular.copy(demo_links);
                }

            }
            $scope.demoConfirmModalSubmit = function () {
                $timeout(function () {
                    $scope.links = angular.copy(demo_links);
                    $('#demoConfirmModal').modal('hide')
                });
            }
            $scope.Add = function () {
                //Add the new item to the Array.
                var link = {};
                link.d = $scope.d;
                link.alpha = $scope.alpha;
                link.a = $scope.a;
                link.theta = $scope.theta;

                var getName = function (ind) {
                    var newName = "Link " + ind
                    for (let i = 0; i < $scope.links.length; i++) {
                        if ($scope.links[i].name && $scope.links[i].name.trim() == newName) {
                            return getName(++ind)
                            break;
                        }
                    }
                    return newName
                }
                link.name = getName($scope.links.length)

                $scope.links.push(link);

                $scope.d = undefined;
                $scope.alpha = undefined;
                $scope.theta = undefined;
                $scope.a = undefined;
            };

            $scope.Remove = function (index) {
                $scope.link_to_remove_index = index;
                $scope.link_to_remove_name = $scope.links[index].name;
                $("#removeConfirmModal").modal('show');
            }
            $scope.RemoveConfirmed = function () {
                $scope.links.splice($scope.link_to_remove_index, 1);
                $scope.link_to_remove_index = undefined;
                $scope.link_to_remove_name = undefined;
                $("#removeConfirmModal").modal('hide');
            }
            $scope.printMatrix = function (l) {
                return $scope.getMatrixHTML($scope.getMatrix(l))
            }
            $scope.getMatrix = function (l) {
                return [
                    [
                        Math.cos(toRad(l.theta)), -Math.sin(toRad(l.theta)) * Math.cos(toRad(l.alpha)), Math.sin(toRad(l.theta)) * Math.sin(toRad(l.alpha)), l.a * Math.cos(toRad(l.theta))
                    ], [
                        Math.sin(toRad(l.theta)), Math.cos(toRad(l.theta)) * Math.cos(toRad(l.alpha)), -Math.cos(toRad(l.theta)) * Math.sin(toRad(l.alpha)), l.a * Math.sin(toRad(l.theta))
                    ], [
                        0, Math.sin(toRad(l.alpha)), Math.cos(toRad(l.alpha)), l.d

                    ], [
                        0, 0, 0, 1
                    ]
                ]
            }


            $scope.getMatrixHTML = function (m) {
                return $sce.trustAsHtml($('<table class="matrix"/>')
                    .append(
                        $('<tr/>')
                            .append(
                                $('<td/>')
                                    .html(precise(m[0][0]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[0][1]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[0][2]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[0][3]))
                            )
                    )
                    .append(
                        $('<tr/>')
                            .append(
                                $('<td/>')
                                    .html(precise(m[1][0]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[1][1]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[1][2]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[1][3]))
                            )
                    )
                    .append(
                        $('<tr/>')
                            .append(
                                $('<td/>')
                                    .html(precise(m[2][0]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[2][1]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[2][2]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[2][3]))
                            )
                    )
                    .append(
                        $('<tr/>')
                            .append(
                                $('<td/>')
                                    .html(precise(m[3][0]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[3][1]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[3][2]))
                            )
                            .append(
                                $('<td/>')
                                    .html(precise(m[3][3]))
                            )
                    ).html())
            }

            $scope.getFinalMatrix = function () {
                var t = [[1, 0, 0, 0],
                [0, 1, 0, 0],
                [0, 0, 1, 0],
                [0, 0, 0, 1]]

                for (let i = 0; i < $scope.links.length; i++) {
                    t = multiply(t, $scope.getMatrix($scope.links[i]))
                }
                return t
            }
            $scope.printFinalMatrix = function () {
                return $scope.getMatrixHTML($scope.getFinalMatrix())
            }
            $scope.openNewWindow = function (url) {
                window.open(url);
            }
        });

        app.directive("floatingNumberOnly", function () {
            return {
                require: 'ngModel',
                link: function (scope, ele, attr, ctrl) {
                    ctrl.$parsers.push(function (inputValue) {
                        var pattern = new RegExp("^[-+]?[0-9]*\.?[0-9]+$", "g");
                        if (inputValue == '') {
                            return '';
                        }
                        var newInput = inputValue.replace(/[^-0-9.]/g, '');
                        var check = pattern.test(inputValue)//On every test, the value is different, so just taking it once

                        if (!check || newInput != inputValue) {
                            //remove multiple dots
                            var parts = newInput.split('.');
                            newInput = parts.shift() + (parts.length ? '.' : '') + parts.join('');

                            //remove multiple, and in middle - signs
                            parts = newInput.split("-")
                            newInput = ((parts.length > 1 && parts[0].length == 0) ? "-" : "") + newInput.replace(/[\-]/g, '')
                        }

                        ctrl.$setViewValue(newInput);
                        ctrl.$render();
                        return newInput;
                    });
                }
            };
        });

        function toRad(angle) {
            return angle * (Math.PI / 180);
        }

        function precise(x) {
            return (Math.round(x * 1e3) / 1e3)
        }
        function multiply(a, b) {
            var aNumRows = a.length, aNumCols = a[0].length,
                bNumRows = b.length, bNumCols = b[0].length,
                m = new Array(aNumRows);  // initialize array of rows
            for (var r = 0; r < aNumRows; ++r) {
                m[r] = new Array(bNumCols); // initialize the current row
                for (var c = 0; c < bNumCols; ++c) {
                    m[r][c] = 0;             // initialize the current cell
                    for (var i = 0; i < aNumCols; ++i) {
                        m[r][c] += a[r][i] * b[i][c];
                    }
                }
            }
            return m;
        }
    </script>
    {{/contentFor}}